# 캠퍼스 공간 및 시간표 시스템 설계 - 25

## 작업 개요

실제 대학생의 팀플 및 스터디 니즈를 반영하여 **빈 강의실 찾기**와 **주간 전체 시간표** 기능을 구현했습니다. 사용자는 시간대와 건물을 필터링하여 사용 가능한 강의실을 찾거나, 주간 전체 수업 일정을 한눈에 확인할 수 있습니다.

---

## 주요 기능

### 1. 전체 시간표 (FullSchedule.tsx)

#### 월~금 그리드 뷰
```tsx
<div className="inline-flex gap-4 min-w-full">
  {days.map((day) => (
    <div className="flex-shrink-0 w-72 bg-white rounded-3xl p-6 shadow-sm">
      {/* 요일 헤더 */}
      <h3 className="text-2xl font-bold text-primary-600">
        {day}요일
      </h3>
      
      {/* 수업 리스트 */}
      {classes.map((classItem) => (
        <div className="p-4 bg-gray-50 rounded-2xl">
          <h4 className="font-bold">{classItem.name}</h4>
          <p>{classItem.time}</p>
          <p className="text-primary-600">{classItem.location}</p>
        </div>
      ))}
    </div>
  ))}
</div>
```

**특징:**
- 가로 스크롤 (overflow-x-auto)
- 카드형 레이아웃 (w-72)
- 모바일 스크롤 힌트

---

### 2. 빈 강의실 찾기 (RoomFinder.tsx)

#### 검색 필터
```tsx
// 건물 선택
<button
  onClick={() => setFilter({ ...filter, building: building })}
  className={`${
    filter.building === building
      ? 'bg-primary-500 text-white'
      : 'bg-gray-100 text-gray-700'
  }`}
>
  {building}
</button>

// 시간대 선택
<input
  type="time"
  value={filter.startTime}
  onChange={(e) => setFilter({ ...filter, startTime: e.target.value })}
/>

// 최소 인원
<button onClick={() => setFilter({ ...filter, minCapacity: 30 })}>
  30명+
</button>
```

**필터 옵션:**
- 건물: IT관, 종합관, 미래창의관
- 시간대: 시작/종료 시간
- 최소 인원: 10명, 20명, 30명, 40명

---

## 데이터 모델링 (TypeScript)

### Room 타입
```typescript
interface Room {
  id: string;              // 강의실 ID (예: "IT-301")
  building: string;        // 건물명
  roomNumber: string;      // 강의실 번호
  capacity: number;        // 수용 인원
  facilities: string[];    // 편의시설 (빔프로젝터, 화이트보드 등)
}
```

### RoomSchedule 타입
```typescript
interface RoomSchedule {
  roomId: string;          // 강의실 ID
  day: number;             // 요일 (0: 일, 1: 월, ...)
  startTime: string;       // 시작 시간 (예: "09:00")
  endTime: string;         // 종료 시간
  className: string;       // 수업명
  professor: string;       // 교수명
}
```

### RoomSearchFilter 타입
```typescript
interface RoomSearchFilter {
  building?: string;       // 건물 필터 (옵션)
  minCapacity?: number;    // 최소 인원 (옵션)
  startTime: string;       // 검색 시작 시간
  endTime: string;         // 검색 종료 시간
  day: number;             // 요일
}
```

### AvailableRoom 타입
```typescript
interface AvailableRoom extends Room {
  isAvailable: boolean;    // 사용 가능 여부
  nextOccupiedTime?: string;  // 다음 사용 시작 시간
}
```

---

## 빈 강의실 검색 DB 로직 설계

### 알고리즘
```typescript
/**
 * 빈 강의실 찾기 로직
 * 1. 전체 강의실 필터링 (건물, 인원)
 * 2. 각 강의실의 해당 요일 스케줄 조회
 * 3. 검색 시간대와 겹치는지 확인
 * 4. 사용 가능한 강의실만 반환
 */
export const findAvailableRooms = (
  rooms: Room[],
  schedules: RoomSchedule[],
  filter: RoomSearchFilter
): AvailableRoom[] => {
  return rooms
    .filter(room => {
      // 건물 필터
      if (filter.building && room.building !== filter.building) {
        return false;
      }
      
      // 최소 인원 필터
      if (filter.minCapacity && room.capacity < filter.minCapacity) {
        return false;
      }
      
      return true;
    })
    .map(room => {
      // 해당 강의실의 해당 요일 스케줄 찾기
      const roomSchedules = schedules.filter(
        s => s.roomId === room.id && s.day === filter.day
      );

      // 검색 시간대에 사용 중인지 확인
      const isOccupied = roomSchedules.some(schedule =>
        isRoomOccupied(schedule, filter.startTime, filter.endTime)
      );

      return {
        ...room,
        isAvailable: !isOccupied
      };
    })
    .filter(room => room.isAvailable);
};
```

### 시간 겹침 확인
```typescript
/**
 * 특정 시간대에 강의실이 사용 중인지 확인
 */
const isRoomOccupied = (
  schedule: RoomSchedule,
  searchStart: string,
  searchEnd: string
): boolean => {
  const scheduleStart = parseTime(schedule.startTime);
  const scheduleEnd = parseTime(schedule.endTime);
  const searchStartMin = parseTime(searchStart);
  const searchEndMin = parseTime(searchEnd);

  // 겹치는 시간이 있는지 확인
  return !(scheduleEnd <= searchStartMin || scheduleStart >= searchEndMin);
};
```

### SQL 쿼리 예시 (실제 DB 연동 시)
```sql
-- 빈 강의실 찾기
SELECT r.*
FROM rooms r
WHERE r.building = 'IT관'  -- 건물 필터
  AND r.capacity >= 30     -- 최소 인원
  AND r.id NOT IN (
    SELECT rs.room_id
    FROM room_schedules rs
    WHERE rs.day = 1  -- 월요일
      AND NOT (
        rs.end_time <= '14:00' OR  -- 검색 시작 전에 끝남
        rs.start_time >= '16:00'   -- 검색 종료 후에 시작
      )
  );
```

---

## 사용자 중심 메뉴 구조

### 개편된 사이드바
```
├─ 📌 메인
│  ├─ 홈
│  └─ AI 챗봇 (NEW)
│
├─ 📚 학사관리
│  ├─ 전체 시간표 (신규!)
│  ├─ E-Class
│  ├─ 공지사항 (3)
│  └─ 성적조회
│
├─ 🏫 캠퍼스 라이프
│  ├─ 빈 강의실 찾기 (신규!)
│  ├─ 학생식당
│  └─ 강의평가
│
└─ 💁 지원
   ├─ 마이페이지
   └─ 도움말
```

**그룹화 원칙:**
- **메인**: 자주 사용
- **학사관리**: 수업/성적 관련
- **캠퍼스 라이프**: 생활 편의
- **지원**: 계정/도움말

---

## 반응형 시간표 구현 전략

### 가로 스크롤 (Horizontal Scroll)
```tsx
<div className="overflow-x-auto pb-4">
  <div className="inline-flex gap-4 min-w-full">
    {/* 카드들 */}
  </div>
</div>
```

**이유:**
- 세로 스크롤: 한 요일씩만 보임
- 가로 스크롤: 여러 요일 비교 가능
- 모바일 친화적: 스와이프 자연스러움

### 카드 고정 너비
```tsx
<div className="flex-shrink-0 w-72">
  {/* 카드 내용 */}
</div>
```

**w-72 (288px):**
- 모바일: 화면 꽉 차게
- 태블릿: 2개 카드
- 데스크톱: 3-4개 카드

---

## 사용 시나리오

### 시나리오 1: 팀플 장소 찾기
```
1. 사이드바 → "빈 강의실 찾기"
   ↓
2. 건물: IT관 선택
   ↓
3. 시간: 14:00 ~ 16:00
   ↓
4. 최소 인원: 4명
   ↓
5. 검색 결과: IT관 301호 (40명)
   "다음 사용: 16:00부터"
```

### 시나리오 2: 주간 일정 확인
```
1. 사이드바 → "전체 시간표"
   ↓
2. 월~금 카드 한눈에 확인
   ↓
3. 가로 스크롤로 요일 비교
   ↓
4. 수요일: 2개 수업
   "공강 많네!"
```

---

## 파일 구조

```
src/
├── pages/
│   ├── FullSchedule.tsx      ← 전체 시간표
│   └── RoomFinder.tsx         ← 빈 강의실 찾기
├── types/
│   └── room.ts                ← Room 관련 타입
├── utils/
│   └── roomHelpers.ts         ← 강의실 검색 로직
└── constants/
    └── menuData.ts            ← 업데이트된 메뉴
```

---

## 유지보수 가이드

### 강의실 데이터 추가
```typescript
// src/pages/RoomFinder.tsx
const rooms: Room[] = [
  { 
    id: 'NEW-101', 
    building: '신관', 
    roomNumber: '101호', 
    capacity: 50, 
    facilities: ['빔프로젝터'] 
  }
];
```

### 스케줄 수기 입력
```typescript
const schedules: RoomSchedule[] = [
  { 
    roomId: 'IT-301', 
    day: 1,  // 월요일
    startTime: '09:00', 
    endTime: '12:00', 
    className: '웹프로그래밍', 
    professor: '김교수' 
  }
];
```

### DB 연동 시 (향후)
```typescript
// API 호출로 변경
const rooms = await fetch('/api/rooms').then(r => r.json());
const schedules = await fetch('/api/schedules').then(r => r.json());
```

---

## 요약

### 구현 완료
1. ✅ 전체 시간표 (가로 스크롤)
2. ✅ 빈 강의실 찾기 (필터)
3. ✅ Room 타입 정의
4. ✅ 검색 로직 분리 (roomHelpers)
5. ✅ 사이드바 메뉴 개편
6. ✅ 라우팅 추가

### 핵심 가치
- 🎯 **팀플 장소 확보**: 강의실 검색
- 📅 **일정 관리**: 주간 시간표
- 🔍 **스마트 필터**: 건물/인원/시간
- 📱 **모바일 최적화**: 가로 스크롤

### 기술 완성도
- TypeScript 타입 안정성
- Clean Code (로직 분리)
- 반응형 디자인
- DB 설계 고려

---

**작성**: 2026-01-23  
**프로젝트 진행률**: 100% 완성 🎉

**다음**: 최종 테스트 및 배포
