# 비밀번호 변경 UI 고도화 - 12

## 작업 개요

비밀번호 변경 페이지를 2단계 프로세스로 재설계하여 보안을 강화하고, "Easy to Use" 원칙에 따라 사용자가 각 단계를 명확히 이해하고 진행할 수 있도록 개선했습니다.

---

## 주요 변경 사항

### 1. 2단계 프로세스 도입

#### Before: 단일 페이지
```
현재 비밀번호
새 비밀번호
새 비밀번호 확인
[변경하기]
```

#### After: 2단계 분리
```
Step 1: 본인인증
├── 현재 비밀번호
├── 휴대폰 번호 (자동입력)
├── 인증번호 발송
├── 인증번호 입력 & 확인
└── [다음 단계]

Step 2: 새 비밀번호
├── 새 비밀번호
├── 새 비밀번호 확인 (실시간 일치 체크)
└── [변경하기]
```

---

### 2. 단계 표시 UI

```tsx
<div className="flex items-center gap-4">
  {/* Step 1 */}
  <div className={`flex items-center gap-2 px-4 py-2 rounded-2xl ${
    currentStep === 1 
      ? 'bg-primary-500 text-white'          // 현재 단계
      : verified 
        ? 'bg-primary-100 text-primary-700'  // 완료
        : 'bg-gray-200 text-gray-500'        // 대기
  }`}>
    <Shield className="w-5 h-5" />
    <span className="font-semibold">1. 본인인증</span>
  </div>

  <ArrowRight className="w-5 h-5 text-gray-400" />

  {/* Step 2 */}
  <div className={`flex items-center gap-2 px-4 py-2 rounded-2xl ${
    currentStep === 2 
      ? 'bg-primary-500 text-white' 
      : 'bg-gray-200 text-gray-500'
  }`}>
    <Lock className="w-5 h-5" />
    <span className="font-semibold">2. 새 비밀번호</span>
  </div>
</div>
```

**상태 색상:**
- 현재 단계: `bg-primary-500 text-white` (연두색 배경, 흰 텍스트)
- 완료 단계: `bg-primary-100 text-primary-700` (연두색 10%, 진한 연두 텍스트)
- 대기 단계: `bg-gray-200 text-gray-500` (회색)

---

## Step 1: 본인인증

### 구성 요소

#### 1. 현재 비밀번호
```tsx
<div className="relative">
  <input
    type={showCurrentPassword ? 'text' : 'password'}
    className="w-full px-4 py-4 rounded-2xl border-2 
      border-gray-200 focus:border-primary-500 
      focus:ring-primary-500 text-lg"
    placeholder="현재 비밀번호를 입력하세요"
  />
  <button className="absolute right-4 top-1/2 -translate-y-1/2">
    {showCurrentPassword ? <EyeOff /> : <Eye />}
  </button>
</div>
```

**특징:**
- Show/Hide 토글 (Eye/EyeOff 아이콘)
- rounded-2xl (부드러운 모서리)
- focus시 #a2c54e 테두리

#### 2. 휴대폰 번호 (자동입력)
```tsx
<div className="flex gap-2">
  <div className="relative flex-grow">
    <Phone className="absolute left-4 top-1/2 -translate-y-1/2" />
    <input
      type="tel"
      value="010-1234-5678"
      readOnly
      className="w-full pl-12 pr-4 py-4 rounded-2xl 
        bg-gray-50 dark:bg-gray-600"
    />
  </div>
  <button
    onClick={handleSendVerification}
    disabled={sentCode}
    className={`px-6 py-4 rounded-2xl font-semibold ${
      sentCode
        ? 'bg-gray-300 text-gray-500 cursor-not-allowed'
        : 'bg-primary-500 text-white hover-lift'
    }`}
  >
    {sentCode ? '발송됨' : '인증번호 발송'}
  </button>
</div>
```

**특징:**
- 자동입력: 기존 등록된 번호 표시
- Read-only: 수정 불가
- Phone 아이콘: 시각적 표시
- 발송 버튼: 연두색 (#a2c54e)
- 발송 후: 회색으로 변경, disabled

#### 3. 인증번호 입력
```tsx
{sentCode && !verified && (
  <motion.div
    initial={{ opacity: 0, height: 0 }}
    animate={{ opacity: 1, height: 'auto' }}
  >
    <div className="flex gap-2">
      <input
        type="text"
        value={verificationCode}
        className="flex-grow px-4 py-4 rounded-2xl 
          border-2 border-gray-200 
          focus:border-primary-500"
        placeholder="인증번호 6자리"
        maxLength={6}
      />
      <button
        onClick={handleVerify}
        className="px-6 py-4 bg-primary-500 text-white 
          rounded-2xl hover-lift"
      >
        확인
      </button>
    </div>
  </motion.div>
)}
```

**특징:**
- 조건부 렌더링: 발송 후에만 표시
- Framer Motion: 부드러운 슬라이드 다운 애니메이션
- maxLength: 6자리 제한
- 확인 버튼: 연두색

#### 4. 인증 완료 메시지
```tsx
{verified && (
  <motion.div
    initial={{ opacity: 0, scale: 0.9 }}
    animate={{ opacity: 1, scale: 1 }}
    className="flex items-center gap-2 p-4 
      bg-primary-50 dark:bg-primary-900/20 
      rounded-2xl border-2 border-primary-200"
  >
    <CheckCircle className="w-5 h-5 text-primary-600" />
    <span className="text-sm font-semibold text-primary-700">
      휴대폰 인증이 완료되었습니다!
    </span>
  </motion.div>
)}
```

**특징:**
- Scale 애니메이션: 약간 커지면서 등장
- 배경: 연두색 5% (`bg-primary-50`)
- 테두리: 연두색 20% (`border-primary-200`)
- CheckCircle 아이콘

---

## Step 2: 새 비밀번호

### 구성 요소

#### 1. 새 비밀번호
```tsx
<div className="relative">
  <input
    type={showNewPassword ? 'text' : 'password'}
    className="w-full px-4 py-4 rounded-2xl border-2 
      border-gray-200 focus:border-primary-500 text-lg"
    placeholder="새 비밀번호를 입력하세요"
  />
  <button className="absolute right-4 top-1/2 -translate-y-1/2">
    {showNewPassword ? <EyeOff /> : <Eye />}
  </button>
</div>
<p className="mt-2 text-sm text-gray-600 flex items-center gap-2">
  <CheckCircle className="w-4 h-4" />
  8자 이상, 영문/숫자/특수문자 조합
</p>
```

**특징:**
- Show/Hide 토글
- 헬퍼 텍스트: 요구사항 표시
- CheckCircle 아이콘

#### 2. 새 비밀번호 확인 (실시간 일치 체크)
```tsx
<div className="relative">
  <input
    type={showConfirmPassword ? 'text' : 'password'}
    value={confirmPassword}
    className={`w-full px-4 py-4 pr-12 rounded-2xl border-2 ${
      passwordsMatch
        ? 'border-primary-500 focus:border-primary-500'  // 일치
        : 'border-gray-200'                               // 기본
    } text-lg`}
    placeholder="새 비밀번호를 다시 입력하세요"
  />
  
  {/* 실시간 일치 체크 아이콘 */}
  <div className="absolute right-12 top-1/2 -translate-y-1/2">
    {passwordsMatch && (
      <CheckCircle className="w-6 h-6 text-primary-600" />
    )}
    {passwordsDontMatch && (
      <XCircle className="w-6 h-6 text-error" />
    )}
  </div>

  <button className="absolute right-4 top-1/2 -translate-y-1/2">
    {showConfirmPassword ? <EyeOff /> : <Eye />}
  </button>
</div>

{/* 일치 메시지 */}
{passwordsMatch && (
  <p className="mt-2 text-sm text-primary-600 flex items-center gap-1">
    <CheckCircle className="w-4 h-4" />
    비밀번호가 일치합니다
  </p>
)}
```

**실시간 검증 로직:**
```typescript
const passwordsMatch = 
  newPassword && confirmPassword && newPassword === confirmPassword;

const passwordsDontMatch = 
  confirmPassword && newPassword !== confirmPassword;
```

**아이콘 위치:**
- CheckCircle/XCircle: `right-12` (Eye 아이콘 왼쪽)
- Eye/EyeOff: `right-4`

**시각적 피드백:**
1. **일치**: 
   - 테두리: `border-primary-500` (연두색)
   - 아이콘: CheckCircle (초록)
   - 메시지: "비밀번호가 일치합니다" (연두색)

2. **불일치**:
   - 아이콘: XCircle (빨강)
   - 에러 메시지 표시

#### 3. 변경하기 버튼
```tsx
<button
  type="submit"
  disabled={!passwordsMatch}
  className={`flex-grow py-4 px-8 rounded-2xl font-semibold text-lg ${
    passwordsMatch
      ? 'bg-primary-500 text-white hover-lift'
      : 'bg-gray-300 text-gray-500 cursor-not-allowed'
  }`}
>
  변경하기
</button>
```

**특징:**
- 조건부 활성화: 비밀번호 일치 시에만 활성화
- 비활성: 회색 배경, cursor-not-allowed
- 활성: 연두색 배경, hover-lift 애니메이션

---

## 사용자 플로우

### 전체 프로세스
```
1. 페이지 접속
   ↓
2. [Step 1] 현재 비밀번호 입력
   ↓
3. 휴대폰 번호 확인 (자동입력)
   ↓
4. 인증번호 발송 클릭
   ↓
5. 인증번호 입력 & 확인
   ↓
6. 인증 완료 메시지 표시
   ↓
7. "다음 단계" 클릭
   ↓
8. [Step 2] 새 비밀번호 입력
   ↓
9. 새 비밀번호 확인 (실시간 일치 체크)
   ↓
10. CheckCircle 표시 & "비밀번호가 일치합니다" 메시지
   ↓
11. "변경하기" 버튼 활성화
   ↓
12. 변경 완료 & 마이페이지로 이동
```

### 에러 핸들링
**Step 1:**
- 현재 비밀번호 미입력: "현재 비밀번호를 입력해주세요"
- 인증 미완료: "휴대폰 인증을 완료해주세요"

**Step 2:**
- 새 비밀번호 미입력: "새 비밀번호를 입력해주세요"
- 비밀번호 형식 오류: "8자 이상, 영문/숫자/특수문자를 포함해야 합니다"
- 비밀번호 불일치: "비밀번호가 일치하지 않습니다"

---

## 디자인 원칙 준수

### ✅ #a2c54e 컬러 테마
- 현재 단계 배지: `bg-primary-500`
- 인증 완료 메시지: `bg-primary-50`, `border-primary-200`
- 발송 버튼: `bg-primary-500`
- 일치 아이콘: `text-primary-600`
- Focus 테두리: `focus:border-primary-500`

### ✅ rounded-2xl 버튼
- 모든 버튼: `rounded-2xl`
- 입력 필드: `rounded-2xl`
- 배지: `rounded-2xl`
- 전체 카드: `rounded-3xl`

### ✅ Easy to Use
- 명확한 단계 표시
- 자동입력된 휴대폰 번호
- 실시간 피드백 (일치 체크)
- 조건부 버튼 활성화

---

## 접근성

### 시각적 피드백
✅ 단계별 색상 구분 (연두/회색)  
✅ 실시간 일치 아이콘 (CheckCircle/XCircle)  
✅ 인증 완료 메시지 (배경색 + 아이콘)  
✅ 버튼 활성/비활성 명확  

### 키보드 네비게이션
✅ Tab으로 모든 필드 이동  
✅ Enter로 폼 제출  
✅ Escape로 취소 (브라우저 기본)  

### 애니메이션
✅ 슬라이드 다운 (인증번호 입력)  
✅ Scale 애니메이션 (인증 완료)  
✅ Fade in (단계 전환)  

---

## 기술 구현

### State 관리
```typescript
const [currentStep, setCurrentStep] = useState(1);
const [currentPassword, setCurrentPassword] = useState('');
const [phoneNumber, setPhoneNumber] = useState('010-1234-5678');
const [verificationCode, setVerificationCode] = useState('');
const [sentCode, setSentCode] = useState(false);
const [verified, setVerified] = useState(false);
const [newPassword, setNewPassword] = useState('');
const [confirmPassword, setConfirmPassword] = useState('');
const [errors, setErrors] = useState<{[key: string]: string}>({});
```

### 실시간 검증
```typescript
const passwordsMatch = 
  newPassword && confirmPassword && newPassword === confirmPassword;

const passwordsDontMatch = 
  confirmPassword && newPassword !== confirmPassword;
```

### 애니메이션
```tsx
<motion.div
  initial={{ opacity: 0, x: -20 }}  // Step 1
  animate={{ opacity: 1, x: 0 }}
>

<motion.form
  initial={{ opacity: 0, x: 20 }}   // Step 2
  animate={{ opacity: 1, x: 0 }}
  onSubmit={handleSubmit}
>
```

---

## 요약

### 변경 사항
1. ✅ 2단계 프로세스 도입 (본인인증 → 새 비밀번호)
2. ✅ 단계 표시 UI (Shield, Lock 아이콘)
3. ✅ 휴대폰 인증 (자동입력 + 인증번호 발송)
4. ✅ 실시간 비밀번호 일치 체크 (CheckCircle/XCircle)
5. ✅ 조건부 버튼 활성화
6. ✅ 부드러운 애니메이션

### 디자인 원칙
- **Easy to Use**: 명확한 단계, 자동입력, 실시간 피드백
- **#a2c54e 테마**: 모든 포인트 색상
- **rounded-2xl**: 모든 버튼 및 입력 필드

### 파일 수정
**수정:**
- `src/pages/PasswordChangePage.tsx` (완전 재설계)

---

**작성**: 2026-01-13  
**다음 작업**: 공지사항 상세 페이지 및 검색 기능 - 13
