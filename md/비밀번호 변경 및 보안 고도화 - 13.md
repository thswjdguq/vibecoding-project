# 비밀번호 변경 및 보안 고도화 - 13

## 작업 개요

"Simple is Best" 철학에 따라 비밀번호 변경 프로세스를 대폭 간소화하고, 휴대폰 인증 중심의 seamless한 UX로 재설계했습니다. 실시간 비밀번호 강도 게이지와 부드러운 카드 전환 애니메이션을 추가하여 현대적이고 안전한 사용자 경험을 제공합니다.

---

## 주요 개선 사항

### 1. 간소화된 인증 프로세스

#### Before (2단계, 복잡)
```
Step 1:
- 현재 비밀번호 입력
- 휴대폰 번호 (자동입력)
- 인증번호 발송
- 인증번호 입력 & 확인
```

#### After (Simple is Best)
```
Step 1:
- 마스킹된 번호 표시 (010-12**-56**)
- [인증번호 받기] 큰 버튼
- 6자리 입력 + 타이머 (03:00)
- PASS 앱 옵션
```

**개선 효과:**
- 현재 비밀번호 제거 → 입력 단계 감소
- 큰 버튼 → 시각적 주목도 증가
- 타이머 → 긴급성 인식

---

### 2. Step 1: 본인 인증

#### 마스킹된 전화번호 표시
```tsx
<div className="p-6 bg-gray-50 dark:bg-gray-700 rounded-2xl text-center">
  <div className="flex items-center justify-center gap-2 mb-2">
    <Phone className="w-5 h-5 text-gray-600" />
    <p className="text-sm text-gray-600">등록된 휴대폰</p>
  </div>
  <p className="text-2xl font-bold text-gray-900 dark:text-white">
    010-12**-56**
  </p>
  <p className="text-xs text-gray-500 mt-2">
    으로 인증번호를 발송합니다
  </p>
</div>
```

**디자인:**
- 배경: `bg-gray-50` (연한 회색)
- 전화번호: `text-2xl font-bold` (큼직하게)
- 마스킹: 중간 4자리 `**` 처리
- Phone 아이콘: 시각적 표시

#### 큰 인증번호 받기 버튼
```tsx
<button
  onClick={handleSendVerification}
  className="w-full py-5 bg-primary-500 text-white rounded-2xl 
    hover-lift font-bold text-xl transition 
    shadow-lg shadow-primary-500/30"
>
  인증번호 받기
</button>
```

**특징:**
- 전체 너비: `w-full`
- 큰 높이: `py-5`
- 큰 텍스트: `text-xl font-bold`
- 그림자: `shadow-lg shadow-primary-500/30` (연두색 그림자)
- Hover: `hover-lift` 애니메이션

#### 인증번호 입력 + 타이머
```tsx
<div className="flex gap-3">
  {/* 인증번호 입력 */}
  <input
    type="text"
    value={verificationCode}
    onChange={(e) => setVerificationCode(
      e.target.value.replace(/\D/g, '').slice(0, 6)
    )}
    className="flex-grow px-6 py-4 rounded-2xl border-2 
      border-gray-200 focus:border-primary-500 
      text-center text-2xl font-bold tracking-widest"
    placeholder="000000"
    maxLength={6}
  />
  
  {/* 타이머 */}
  <div className="flex items-center justify-center px-6 py-4 
    bg-gray-100 dark:bg-gray-700 rounded-2xl min-w-[100px]">
    <span className={`text-xl font-bold ${
      timeLeft < 60 ? 'text-error' : 'text-primary-600'
    }`}>
      {formatTime(timeLeft)}
    </span>
  </div>
</div>
```

**타이머 로직:**
```typescript
const [timeLeft, setTimeLeft] = useState(180); // 3분

useEffect(() => {
  if (sentCode && !verified && timeLeft > 0) {
    const timer = setInterval(() => {
      setTimeLeft(prev => prev - 1);
    }, 1000);
    return () => clearInterval(timer);
  }
}, [sentCode, verified, timeLeft]);

const formatTime = (seconds: number) => {
  const mins = Math.floor(seconds / 60);
  const secs = seconds % 60;
  return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
};
```

**타이머 색상:**
- 60초 이상: `text-primary-600` (연두색)
- 60초 미만: `text-error` (빨강) - 긴급

**입력 필드:**
- 숫자만: `replace(/\D/g, '')`
- 6자리 제한: `slice(0, 6)`
- 중앙 정렬: `text-center`
- 큰 텍스트: `text-2xl font-bold`
- 넓은 간격: `tracking-widest`

#### PASS 앱 인증 (보조)
```tsx
{/* 구분선 */}
<div className="relative">
  <div className="absolute inset-0 flex items-center">
    <div className="w-full border-t border-gray-300"></div>
  </div>
  <div className="relative flex justify-center text-sm">
    <span className="px-4 bg-white text-gray-500">또는</span>
  </div>
</div>

{/* PASS 버튼 */}
<button
  onClick={handlePassAuth}
  className="w-full py-3 border-2 border-gray-300 
    text-gray-700 rounded-2xl 
    hover:border-primary-500 hover:text-primary-600 
    transition flex items-center justify-center gap-2 font-semibold"
>
  <Smartphone className="w-5 h-5" />
  PASS 앱으로 인증하기
</button>
```

**특징:**
- 보조 수단: 주 버튼보다 작게
- Outline 스타일: `border-2`
- Hover: 연두색으로 변경
- Smartphone 아이콘

---

### 3. Step 2: 새 비밀번호

#### 카드 슬라이드 애니메이션
```tsx
<AnimatePresence mode="wait">
  {currentStep === 1 ? (
    <motion.div
      key="step1"
      initial={{ opacity: 0, x: -50 }}
      animate={{ opacity: 1, x: 0 }}
      exit={{ opacity: 0, x: -50 }}
    >
      {/* Step 1 내용 */}
    </motion.div>
  ) : (
    <motion.form
      key="step2"
      initial={{ opacity: 0, x: 50 }}
      animate={{ opacity: 1, x: 0 }}
      exit={{ opacity: 0, x: 50 }}
    >
      {/* Step 2 내용 */}
    </motion.form>
  )}
</AnimatePresence>
```

**애니메이션:**
- Step 1 → 2: 왼쪽으로 밀림 (`x: -50 → 0 → -50`)
- Step 2 등장: 오른쪽에서 등장 (`x: 50 → 0`)
- AnimatePresence: 부드러운 전환
- mode="wait": 이전 카드가 완전히 사라진 후 다음 카드 등장

#### 비밀번호 강도 게이지
```tsx
const getPasswordStrength = (password: string) => {
  if (!password) return { level: 0, text: '', color: '' };
  
  let score = 0;
  if (password.length >= 8) score++;
  if (password.length >= 12) score++;
  if (/[a-z]/.test(password) && /[A-Z]/.test(password)) score++;
  if (/[0-9]/.test(password)) score++;
  if (/[!@#$%^&*(),.?":{}|<>]/.test(password)) score++;

  if (score <= 2) return { level: 1, text: '위험', color: 'bg-error' };
  if (score <= 3) return { level: 2, text: '보통', color: 'bg-orange-500' };
  return { level: 3, text: '안전', color: 'bg-primary-500' };
};
```

**점수 기준:**
- 8자 이상: +1
- 12자 이상: +1 (추가)
- 대소문자 혼합: +1
- 숫자 포함: +1
- 특수문자 포함: +1

**강도 레벨:**
- 0-2점: **위험** (빨강)
- 3점: **보통** (주황)
- 4-5점: **안전** (연두)

**UI 표시:**
```tsx
{newPassword && (
  <motion.div
    initial={{ opacity: 0, height: 0 }}
    animate={{ opacity: 1, height: 'auto' }}
    className="mt-3"
  >
    <div className="flex items-center justify-between mb-2">
      <span className="text-sm text-gray-600">비밀번호 강도</span>
      <span className={`text-sm font-bold ${
        passwordStrength.level === 1 ? 'text-error' :
        passwordStrength.level === 2 ? 'text-orange-500' :
        'text-primary-600'
      }`}>
        {passwordStrength.text}
      </span>
    </div>
    <div className="h-2 bg-gray-200 rounded-full overflow-hidden">
      <motion.div
        initial={{ width: 0 }}
        animate={{ width: `${(passwordStrength.level / 3) * 100}%` }}
        className={`h-full ${passwordStrength.color} transition-all duration-300`}
      />
    </div>
  </motion.div>
)}
```

**게이지 바:**
- 높이: `h-2`
- 배경: `bg-gray-200` (회색)
- Border radius: `rounded-full`
- 너비: `(level / 3) * 100%`
  - Level 1: 33%
  - Level 2: 66%
  - Level 3: 100%

**색상:**
- 위험: `bg-error` (빨강)
- 보통: `bg-orange-500` (주황)
- 안전: `bg-primary-500` (연두)

#### 전체 너비 변경 완료 버튼
```tsx
<button
  type="submit"
  disabled={!passwordsMatch || passwordStrength.level < 2}
  className={`w-full py-5 rounded-2xl font-bold text-xl transition mt-6 ${
    passwordsMatch && passwordStrength.level >= 2
      ? 'bg-primary-500 text-white hover-lift shadow-lg shadow-primary-500/30'
      : 'bg-gray-300 text-gray-500 cursor-not-allowed'
  }`}
>
  비밀번호 변경 완료
</button>
```

**특징:**
- 전체 너비: `w-full`
- 큰 높이: `py-5`
- 큰 텍스트: `text-xl font-bold`
- 그림자: `shadow-lg shadow-primary-500/30`
- 활성화 조건: 비밀번호 일치 + 강도 2 이상

---

## 사용자 플로우

```
1. 페이지 접속
   ↓
2. 마스킹된 번호 확인 (010-12**-56**)
   ↓
3. [인증번호 받기] 클릭 → 큰 버튼 클릭
   ↓
4. 6자리 입력창 + 타이머 (03:00) 표시
   ↓
5. 인증번호 입력
   ↓
6. [인증 확인] 클릭
   ↓
7. 카드 슬라이드 (왼쪽으로 밀림)
   ↓
8. Step 2 등장 (오른쪽에서)
   ↓
9. 새 비밀번호 입력
   ↓
10. 강도 게이지 실시간 표시 (위험/보통/안전)
   ↓
11. 비밀번호 확인 입력
   ↓
12. CheckCircle 표시
   ↓
13. [비밀번호 변경 완료] 버튼 활성화
   ↓
14. 변경 완료 & 마이페이지로 이동
```

---

## 디자인 원칙 준수

### ✅ Simple is Best
- 현재 비밀번호 제거
- 큰 버튼으로 주요 액션 강조
- 명확한 단계 구분

### ✅ #a2c54e 연두색 포인트
- 인증번호 받기 버튼 배경
- 타이머 (60초 이상)
- 강도 게이지 (안전)
- Focus 테두리
- 변경 완료 버튼
- 그림자 효과

### ✅ rounded-2xl
- 모든 버튼: `rounded-2xl`
- 입력 필드: `rounded-2xl`
- 전체 카드: `rounded-3xl`

### ✅ 청량감
- 연두색 그림자: `shadow-primary-500/30`
- 부드러운 애니메이션
- 넓은 여백

---

## 접근성

### 시각적 피드백
✅ 실시간 강도 게이지 (색상 + 텍스트)  
✅ 타이머 색상 변경 (60초 미만 빨강)  
✅ 비밀번호 일치 CheckCircle  
✅ 버튼 활성/비활성 명확  

### 애니메이션
✅ 카드 슬라이드 (Framer Motion)  
✅ 게이지 바 애니메이션  
✅ 입력창 슬라이드 다운  

### 키보드 네비게이션
✅ Tab으로 모든 필드 이동  
✅ Enter로 폼 제출  

---

## 기술 구현

### State 관리
```typescript
const [currentStep, setCurrentStep] = useState(1);
const [verificationCode, setVerificationCode] = useState('');
const [sentCode, setSentCode] = useState(false);
const [verified, setVerified] = useState(false);
const [timeLeft, setTimeLeft] = useState(180);
const [newPassword, setNewPassword] = useState('');
const [confirmPassword, setConfirmPassword] = useState('');
```

### 타이머 구현
```typescript
useEffect(() => {
  if (sentCode && !verified && timeLeft > 0) {
    const timer = setInterval(() => {
      setTimeLeft(prev => prev - 1);
    }, 1000);
    return () => clearInterval(timer);
  }
}, [sentCode, verified, timeLeft]);
```

### 강도 계산
```typescript
const getPasswordStrength = (password: string) => {
  let score = 0;
  // 5가지 기준 평가
  // 점수에 따라 level/text/color 반환
};
```

---

## 요약

### 변경 사항
1. ✅ 현재 비밀번호 제거 (Simple is Best)
2. ✅ 마스킹된 전화번호 (010-12**-56**)
3. ✅ 3분 타이머 + 색상 변경
4. ✅ PASS 앱 인증 옵션
5. ✅ 비밀번호 강도 게이지 (위험/보통/안전)
6. ✅ Framer Motion 카드 슬라이드
7. ✅ 전체 너비 큰 버튼

### 디자인 원칙
- **Simple is Best**: 최소 입력, 명확한 단계
- **#a2c54e 청량감**: 모든 포인트 색상
- **rounded-2xl**: 부드러운 모서리

### 파일 수정
**수정:**
- `src/pages/PasswordChangePage.tsx` (완전 재설계)

---

**작성**: 2026-01-13  
**다음 작업**: 공지사항 페이지 상세 구현 - 14
